"use strict";(self.webpackChunkanvil_code_walkthrough=self.webpackChunkanvil_code_walkthrough||[]).push([[5160],{7309:(r,e,n)=>{n.r(e),n.d(e,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"anvil/architecture/rpc-types","title":"RPC \u7c7b\u578b\u4e0e\u7f16\u89e3\u7801","description":"\u6982\u8ff0\uff1arpc/src/lib.rs\u3001rpc/src/request.rs\u3001rpc/src/response.rs\u3001rpc/src/error.rs \u63cf\u8ff0 JSON-RPC \u7684\u8bf7\u6c42/\u54cd\u5e94\u6a21\u578b\u4e0e\u9519\u8bef\u8bed\u4e49\uff0c\u5e76\u88ab\u4f20\u8f93\u5c42\u4e0e\u4ee5\u592a\u574a API \u6d88\u8d39\u3002","source":"@site/docs/anvil/architecture/rpc-types.md","sourceDirName":"anvil/architecture","slug":"/anvil/architecture/rpc-types","permalink":"/anvil-code-walkthrough/docs/anvil/architecture/rpc-types","draft":false,"unlisted":false,"editUrl":"https://github.com/Thneoly/anvil-code-walkthrough/edit/main/docs/anvil/architecture/rpc-types.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"RPC \u7c7b\u578b\u4e0e\u7f16\u89e3\u7801","sidebar_position":3,"base_commit":"575bf62c","upstream_repo":"foundry-rs/foundry","upstream_path":"crates/anvil/rpc/src/"},"sidebar":"tutorialSidebar","previous":{"title":"\u4f20\u8f93\u5c42\u4e0e\u8bf7\u6c42\u5165\u53e3\uff08Server/Handler\uff09","permalink":"/anvil-code-walkthrough/docs/anvil/architecture/transport"},"next":{"title":"\u8fc7\u6ee4\u5668","permalink":"/anvil-code-walkthrough/docs/anvil/architecture/filter"}}');var t=n(4848),c=n(8453);const i={title:"RPC \u7c7b\u578b\u4e0e\u7f16\u89e3\u7801",sidebar_position:3,base_commit:"575bf62c",upstream_repo:"foundry-rs/foundry",upstream_path:"crates/anvil/rpc/src/"},l=void 0,d={},o=[{value:"\u6a21\u5757\u7ed3\u6784",id:"\u6a21\u5757\u7ed3\u6784",level:2},{value:"\u793a\u4f8b\uff08\u5355\u8bf7\u6c42\uff09",id:"\u793a\u4f8b\u5355\u8bf7\u6c42",level:2},{value:"\u793a\u4f8b\uff08\u6279\u5904\u7406\uff09",id:"\u793a\u4f8b\u6279\u5904\u7406",level:2},{value:"\u901a\u77e5\uff08\u65e0 id\uff09",id:"\u901a\u77e5\u65e0-id",level:2},{value:"\u9519\u8bef\u4e0e\u6620\u5c04",id:"\u9519\u8bef\u4e0e\u6620\u5c04",level:2},{value:"\u8fb9\u754c\u4e0e\u6ce8\u610f\u4e8b\u9879",id:"\u8fb9\u754c\u4e0e\u6ce8\u610f\u4e8b\u9879",level:2}];function a(r){const e={a:"a",code:"code",h2:"h2",li:"li",mermaid:"mermaid",p:"p",pre:"pre",ul:"ul",...(0,c.R)(),...r.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(e.p,{children:["\u6982\u8ff0\uff1a",(0,t.jsx)(e.code,{children:"rpc/src/lib.rs"}),"\u3001",(0,t.jsx)(e.code,{children:"rpc/src/request.rs"}),"\u3001",(0,t.jsx)(e.code,{children:"rpc/src/response.rs"}),"\u3001",(0,t.jsx)(e.code,{children:"rpc/src/error.rs"})," \u63cf\u8ff0 JSON-RPC \u7684\u8bf7\u6c42/\u54cd\u5e94\u6a21\u578b\u4e0e\u9519\u8bef\u8bed\u4e49\uff0c\u5e76\u88ab\u4f20\u8f93\u5c42\u4e0e\u4ee5\u592a\u574a API \u6d88\u8d39\u3002"]}),"\n",(0,t.jsx)(e.p,{children:"\u5feb\u901f\u94fe\u63a5\uff1a"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\u6e90\u7801\uff08request\uff09\uff1a",(0,t.jsx)(e.a,{href:"https://github.com/foundry-rs/foundry/blob/575bf62c/crates/anvil/rpc/src/request.rs",children:"https://github.com/foundry-rs/foundry/blob/575bf62c/crates/anvil/rpc/src/request.rs"})]}),"\n",(0,t.jsxs)(e.li,{children:["\u6e90\u7801\uff08response\uff09\uff1a",(0,t.jsx)(e.a,{href:"https://github.com/foundry-rs/foundry/blob/575bf62c/crates/anvil/rpc/src/response.rs",children:"https://github.com/foundry-rs/foundry/blob/575bf62c/crates/anvil/rpc/src/response.rs"})]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"\u6a21\u5757\u7ed3\u6784",children:"\u6a21\u5757\u7ed3\u6784"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"request.rs\uff1a\u5b9a\u4e49 Request/Id/Params \u7b49\u7ed3\u6784\uff0c\u652f\u6301\u5355\u8bf7\u6c42\u4e0e\u6279\u5904\u7406\u3002"}),"\n",(0,t.jsx)(e.li,{children:"response.rs\uff1a\u5b9a\u4e49 Response/Result/BatchResponse \u7b49\u7ed3\u6784\u3002"}),"\n",(0,t.jsx)(e.li,{children:"error.rs\uff1aJSON-RPC \u6807\u51c6\u9519\u8bef\u4e0e\u81ea\u5b9a\u4e49\u6269\u5c55\uff08\u9519\u8bef\u7801/\u4fe1\u606f\uff09\u3002"}),"\n",(0,t.jsx)(e.li,{children:"lib.rs\uff1a\u5bf9\u5916\u5bfc\u51fa\u4e0e\u516c\u5171\u7c7b\u578b\u7ec4\u5408\u3002"}),"\n"]}),"\n",(0,t.jsx)(e.mermaid,{value:'classDiagram\n\tclass Request {\n\t\t+jsonrpc: "2.0"\n\t\t+id: Id\n\t\t+method: String\n\t\t+params: Params?\n\t}\n\tclass Response {\n\t\t+jsonrpc: "2.0"\n\t\t+id: Id\n\t\t+result: any\n\t}\n\tclass ErrorResponse {\n\t\t+jsonrpc: "2.0"\n\t\t+id: Id\n\t\t+error: RpcError\n\t}\n\tclass RpcError {\n\t\t+code: i32\n\t\t+message: String\n\t\t+data: any?\n\t}\n\tRequest <|-- BatchRequest\n\tResponse <|-- BatchResponse\n\tErrorResponse ..> RpcError'}),"\n",(0,t.jsx)(e.h2,{id:"\u793a\u4f8b\u5355\u8bf7\u6c42",children:"\u793a\u4f8b\uff08\u5355\u8bf7\u6c42\uff09"}),"\n",(0,t.jsx)(e.p,{children:"\u8bf7\u6c42\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-json",children:'{\n\t"jsonrpc": "2.0",\n\t"id": 1,\n\t"method": "eth_chainId",\n\t"params": []\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u54cd\u5e94\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-json",children:'{\n\t"jsonrpc": "2.0",\n\t"id": 1,\n\t"result": "0x7a69"\n}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"\u793a\u4f8b\u6279\u5904\u7406",children:"\u793a\u4f8b\uff08\u6279\u5904\u7406\uff09"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-json",children:'[\n\t{"jsonrpc":"2.0","id":1,"method":"net_version","params":[]},\n\t{"jsonrpc":"2.0","id":2,"method":"eth_chainId","params":[]}\n]\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u8fd4\u56de\u53ef\u80fd\u662f\u6309\u8bf7\u6c42\u5b8c\u6210\u987a\u5e8f\u7684\u6570\u7ec4\uff08\u975e\u5fc5\u987b\u4fdd\u5e8f\uff09\uff0c\u8c03\u7528\u65b9\u9700\u6309 id \u5bf9\u9f50\u3002"}),"\n",(0,t.jsx)(e.h2,{id:"\u901a\u77e5\u65e0-id",children:"\u901a\u77e5\uff08\u65e0 id\uff09"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"JSON-RPC \u901a\u77e5\u4e0d\u5305\u542b id\uff0c\u670d\u52a1\u7aef\u4e0d\u8fd4\u56de\u54cd\u5e94\u3002"}),"\n",(0,t.jsx)(e.li,{children:"\u4f7f\u7528\u573a\u666f\uff1a\u8ba2\u9605\u7684\u5185\u90e8\u63e1\u624b\u3001\u975e\u5173\u952e\u4e0a\u62a5\u7b49\uff08\u5efa\u8bae\u8c28\u614e\u4f7f\u7528\uff0c\u907f\u514d\u5ba2\u6237\u7aef\u7b49\u5f85\u54cd\u5e94\uff09\u3002"}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"\u9519\u8bef\u4e0e\u6620\u5c04",children:"\u9519\u8bef\u4e0e\u6620\u5c04"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u6807\u51c6\u9519\u8bef\u7801\uff1a-32600\uff08\u65e0\u6548\u8bf7\u6c42\uff09\u3001-32601\uff08\u65b9\u6cd5\u4e0d\u5b58\u5728\uff09\u3001-32602\uff08\u53c2\u6570\u65e0\u6548\uff09\u3001-32603\uff08\u5185\u90e8\u9519\u8bef\uff09\u3002"}),"\n",(0,t.jsxs)(e.li,{children:["\u4f20\u8f93\u4e0e\u4e1a\u52a1\u6620\u5c04\uff1a",(0,t.jsx)(e.code,{children:"server/error.rs"}),"\u3001",(0,t.jsx)(e.code,{children:"rpc/error.rs"}),"\u3001",(0,t.jsx)(e.code,{children:"src/eth/error.rs"})," \u5171\u540c\u51b3\u5b9a\u6700\u7ec8\u9519\u8bef\u4f53\u3002"]}),"\n",(0,t.jsx)(e.li,{children:"\u65e5\u5fd7\u7ea7\u522b\uff1a\u53c2\u6570\u9519\u8bef\u901a\u5e38\u4e3a warn\uff0c\u5185\u90e8\u9519\u8bef\u5efa\u8bae error \u5e76\u5e26\u4e0a trace id/\u8bf7\u6c42\u6458\u8981\u3002"}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"\u8fb9\u754c\u4e0e\u6ce8\u610f\u4e8b\u9879",children:"\u8fb9\u754c\u4e0e\u6ce8\u610f\u4e8b\u9879"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u6279\u5904\u7406\u4f53\u79ef\uff1a\u9650\u5236\u5355\u6279\u8bf7\u6c42\u6570\u91cf\u4e0e\u603b\u5b57\u8282\uff0c\u907f\u514d\u653e\u5927 CPU/\u5185\u5b58\u5f00\u9500\u3002"}),"\n",(0,t.jsx)(e.li,{children:"\u53c2\u6570\u89e3\u7801\uff1a\u4e25\u683c\u7c7b\u578b\u6821\u9a8c\u5e76\u63d0\u4f9b\u53cb\u597d\u9519\u8bef\u4fe1\u606f\uff08\u4f4d\u7f6e/\u5b57\u6bb5\u540d\uff09\u3002"}),"\n",(0,t.jsx)(e.li,{children:"\u975e\u6cd5 id\uff1aid \u5fc5\u987b\u4e3a\u5b57\u7b26\u4e32/\u6570\u5b57\u6216 null\uff1b\u4e0d\u652f\u6301\u5bf9\u8c61/\u6570\u7ec4\u578b id\u3002"}),"\n",(0,t.jsx)(e.li,{children:"\u987a\u5e8f\u5047\u8bbe\uff1a\u6279\u5904\u7406\u54cd\u5e94\u4e0d\u4fdd\u8bc1\u987a\u5e8f\uff0c\u52a1\u5fc5\u6839\u636e id \u5173\u8054\u7ed3\u679c\u3002"}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:"\u540e\u7eed\u8865\u5145\uff1a"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u5e38\u89c1\u4ee5\u592a\u574a\u65b9\u6cd5\u7684\u53c2\u6570/\u8fd4\u56de\u503c\u901f\u67e5\u8868\uff08\u94fe\u63a5\u5230\u76f8\u5e94\u7ae0\u8282\uff09\u3002"}),"\n",(0,t.jsx)(e.li,{children:"\u9519\u8bef\u7801\u4e0e HTTP \u72b6\u6001\uff08\u82e5\u6709\u4ee3\u7406\uff09\u4e4b\u95f4\u7684\u5bf9\u5e94\u5173\u7cfb\u8bf4\u660e\u3002"}),"\n"]})]})}function h(r={}){const{wrapper:e}={...(0,c.R)(),...r.components};return e?(0,t.jsx)(e,{...r,children:(0,t.jsx)(a,{...r})}):a(r)}},8453:(r,e,n)=>{n.d(e,{R:()=>i,x:()=>l});var s=n(6540);const t={},c=s.createContext(t);function i(r){const e=s.useContext(c);return s.useMemo(function(){return"function"==typeof r?r(e):{...e,...r}},[e,r])}function l(r){let e;return e=r.disableParentContext?"function"==typeof r.components?r.components(t):r.components||t:i(r.components),s.createElement(c.Provider,{value:e},r.children)}}}]);