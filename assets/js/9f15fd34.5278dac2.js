"use strict";(self.webpackChunkanvil_code_walkthrough=self.webpackChunkanvil_code_walkthrough||[]).push([[2095],{8453:(n,e,r)=>{r.d(e,{R:()=>l,x:()=>o});var i=r(6540);const s={},c=i.createContext(s);function l(n){const e=i.useContext(c);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:l(n.components),i.createElement(c.Provider,{value:e},n.children)}},9083:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>t,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"anvil/config/config","title":"\u914d\u7f6e\u7cfb\u7edf\uff08config.rs\uff09","description":"\u6982\u8ff0\uff1asrc/config.rs \u5b9a\u4e49\u8fd0\u884c\u671f\u914d\u7f6e\u4e0e\u9ed8\u8ba4\u7b56\u7565\uff0c\u8d2f\u7a7f\u8282\u70b9\u88c5\u914d\u3001EVM \u73af\u5883\u6784\u5efa\u3001\u6316\u77ff/\u65f6\u95f4\u884c\u4e3a\u3001\u5206\u53c9\u3001\u8d26\u6237\u4e0e\u6301\u4e45\u5316\u7b49\u6838\u5fc3\u8def\u5f84\uff0c\u6700\u7ec8\u5728 service.rs \u88ab\u6d88\u8d39\u3002","source":"@site/docs/anvil/config/config.md","sourceDirName":"anvil/config","slug":"/anvil/config/","permalink":"/anvil-code-walkthrough/docs/anvil/config/","draft":false,"unlisted":false,"editUrl":"https://github.com/Thneoly/anvil-code-walkthrough/edit/main/docs/anvil/config/config.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"id":"config","title":"\u914d\u7f6e\u7cfb\u7edf\uff08config.rs\uff09","sidebar_label":"\u914d\u7f6e\u7cfb\u7edf","sidebar_position":1,"base_commit":"575bf62c","upstream_repo":"foundry-rs/foundry","upstream_path":"crates/anvil/src/config.rs"},"sidebar":"tutorialSidebar","previous":{"title":"\u914d\u7f6e\u4e0e\u542f\u52a8","permalink":"/anvil-code-walkthrough/docs/category/\u914d\u7f6e\u4e0e\u542f\u52a8"},"next":{"title":"CLI \u4e0e\u5b50\u547d\u4ee4","permalink":"/anvil-code-walkthrough/docs/anvil/config/cli"}}');var s=r(4848),c=r(8453);const l={id:"config",title:"\u914d\u7f6e\u7cfb\u7edf\uff08config.rs\uff09",sidebar_label:"\u914d\u7f6e\u7cfb\u7edf",sidebar_position:1,base_commit:"575bf62c",upstream_repo:"foundry-rs/foundry",upstream_path:"crates/anvil/src/config.rs"},o=void 0,t={},d=[];function a(n){const e={a:"a",code:"code",li:"li",mermaid:"mermaid",p:"p",ul:"ul",...(0,c.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(e.p,{children:["\u6982\u8ff0\uff1a",(0,s.jsx)(e.code,{children:"src/config.rs"})," \u5b9a\u4e49\u8fd0\u884c\u671f\u914d\u7f6e\u4e0e\u9ed8\u8ba4\u7b56\u7565\uff0c\u8d2f\u7a7f\u8282\u70b9\u88c5\u914d\u3001EVM \u73af\u5883\u6784\u5efa\u3001\u6316\u77ff/\u65f6\u95f4\u884c\u4e3a\u3001\u5206\u53c9\u3001\u8d26\u6237\u4e0e\u6301\u4e45\u5316\u7b49\u6838\u5fc3\u8def\u5f84\uff0c\u6700\u7ec8\u5728 ",(0,s.jsx)(e.code,{children:"service.rs"})," \u88ab\u6d88\u8d39\u3002"]}),"\n",(0,s.jsx)(e.p,{children:"\u5feb\u901f\u94fe\u63a5\uff1a"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\u6e90\u7801\uff08config.rs\uff09\uff1a",(0,s.jsx)(e.a,{href:"https://github.com/foundry-rs/foundry/blob/575bf62c/crates/anvil/src/config.rs",children:"https://github.com/foundry-rs/foundry/blob/575bf62c/crates/anvil/src/config.rs"})]}),"\n",(0,s.jsx)(e.li,{children:"\u6e90\u7801\uff08service.rs \u88c5\u914d\uff09\uff1aref/foundry-575bf62c/crates/anvil/src/service.rs"}),"\n",(0,s.jsx)(e.li,{children:"\u6e90\u7801\uff08opts/args/cmd\uff09\uff1aref/foundry-575bf62c/crates/anvil/src/opts.rs\uff0cref/foundry-575bf62c/crates/anvil/src/args.rs\uff0cref/foundry-575bf62c/crates/anvil/src/cmd.rs"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u88c5\u914d\u5173\u7cfb\uff1a"}),"\n",(0,s.jsx)(e.mermaid,{value:'flowchart LR\n  A["CLI/Env"] --\x3e B["Config"]\n  B --\x3e C["Service \u88c5\u914d"]\n  C --\x3e D["Transport(HTTP/WS/IPC)"]\n  C --\x3e E["TxPool/Miner"]\n  C --\x3e F["EVM Backend"]\n  C --\x3e G["Fork Provider"]'}),"\n",(0,s.jsx)(e.p,{children:"\u5173\u952e\u5b57\u6bb5\u8981\u70b9\uff1a"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\u94fe\u4e0e\u786c\u5206\u53c9","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"chain_id\uff1a\u5f71\u54cd\u7b7e\u540d\u4fdd\u62a4\uff08EIP-155\uff09\u3002"}),"\n",(0,s.jsx)(e.li,{children:"hardfork\uff1a\u51b3\u5b9a EVM \u89c4\u5219\u96c6\uff1b\u5f71\u54cd baseFee\u3001blobgas\u3001warm/cold \u7b49\u884c\u4e3a\u3002"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\u51fa\u5757/\u65f6\u95f4","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:'mining\uff1a"auto"/"interval"/"instant"/"none"\uff1b\u4e0e "block_time_ms" \u914d\u5408\u3002'}),"\n",(0,s.jsx)(e.li,{children:"timestamp \u7b56\u7565\uff1a\u624b\u52a8\u63a8\u8fdb vs \u7cfb\u7edf\u65f6\u949f\uff1b\u5f71\u54cd\u6d4b\u8bd5\u7a33\u5b9a\u6027\u3002"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\u8d39\u7528\u5e02\u573a","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"base_fee\u3001gas_price\u3001priority_fee\uff1a\u9ed8\u8ba4\u8d39\u7387\u4e0e 1559/4844 \u8def\u5f84\u5f00\u5173\u3002"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\u5206\u53c9\uff08Fork\uff09","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"fork_url/fork_block\uff1a\u8fdc\u7a0b\u94fe\u6570\u636e\u6e90\u53ca\u56fa\u5b9a\u9ad8\u5ea6\uff1b\u5f00\u542f\u540e\u7f3a\u5931\u72b6\u6001\u56de\u6e90\u52a0\u8f7d\u3002"}),"\n",(0,s.jsx)(e.li,{children:"fork_headers\uff1a\u662f\u5426\u900f\u4f20\u8fdc\u7aef\u5934\u90e8\u4ee5\u5f71\u54cd baseFee \u7b49\u3002"}),"\n",(0,s.jsx)(e.li,{children:"state_overrides\uff1a\u672c\u5730\u8986\u76d6\u8fdc\u7aef\u8d26\u6237/\u5b58\u50a8/\u4ee3\u7801\uff0c\u4fbf\u4e8e\u53ef\u63a7\u6d4b\u8bd5\u3002"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\u8d26\u6237","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u52a9\u8bb0\u8bcd\u3001\u6570\u91cf\u3001\u8d77\u59cb\u7d22\u5f15\u3001\u9884\u6ce8\u8d44\u3001\u89e3\u9501\uff1b\u662f\u5426\u5141\u8bb8\u5192\u5145\uff08impersonate\uff09\u3002"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\u6301\u4e45\u5316\u4e0e\u6570\u636e\u76ee\u5f55","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\u5185\u5b58/\u78c1\u76d8/\u5feb\u7167\uff1b\u5f71\u54cd ",(0,s.jsx)(e.code,{children:"evm_snapshot/evm_revert"})," \u4e0e\u91cd\u542f\u540e\u7684\u53ef\u91cd\u73b0\u6027\u3002"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\u670d\u52a1\u7aef\u53e3\u4e0e\u5b89\u5168","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"http/ws/ipc \u76d1\u542c\u3001\u4e3b\u673a\u540d\u3001CORS\u3001max body\u3001\u8ba2\u9605\u9650\u6d41\u7b49\u3002"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\u65e5\u5fd7\u4e0e\u53ef\u89c2\u6d4b\u6027","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u7ea7\u522b\u3001\u683c\u5f0f\uff08plain/json\uff09\u3001tracing \u5f00\u5173\u3001\u6162\u8c03\u7528\u9608\u503c\u7b49\u3002"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u5e38\u89c1\u9677\u9631\uff1a"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u672a\u9489\u6b7b fork_block \u65f6\u8fdc\u7aef\u94fe\u63a8\u8fdb\u5bfc\u81f4\u6d4b\u8bd5\u6f02\u79fb\uff1b\u5efa\u8bae\u56fa\u5b9a\u9ad8\u5ea6\u3002"}),"\n",(0,s.jsx)(e.li,{children:'mining="instant" \u5728\u9ad8\u5e76\u53d1\u4e0b\u53ef\u80fd\u6539\u53d8\u4ea4\u6613\u76f8\u5bf9\u987a\u5e8f\uff1b\u9700\u7ed3\u5408 TxPool \u6392\u5e8f\u7b56\u7565\u3002'}),"\n",(0,s.jsx)(e.li,{children:"\u540c\u65f6\u8bbe\u7f6e base_fee \u4e0e gas_price \u65f6\u9700\u660e\u786e\u4f18\u5148\u7ea7\uff0c\u907f\u514d\u8d39\u7528\u65ad\u8a00\u6f02\u79fb\u3002"}),"\n",(0,s.jsx)(e.li,{children:'persistence="memory" \u91cd\u542f\u540e\u5feb\u7167\u4e22\u5931\uff1bCI \u4e2d\u5efa\u8bae\u7528 snapshot/revert\u3002'}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u9a8c\u8bc1\u5efa\u8bae\uff1a"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u542f\u52a8\u65f6\u6253\u5370 Config\uff08debug \u7ea7\u522b\uff09\uff0c\u5bf9\u7167 CLI/\u9ed8\u8ba4\u503c\u6838\u9a8c\uff1b\u5199 1-2 \u4e2a smoke \u8986\u76d6\u6316\u77ff/\u65f6\u95f4\u4e0e fork \u884c\u4e3a\u3002"}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,c.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(a,{...n})}):a(n)}}}]);